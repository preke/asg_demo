FREAK for Real Time Forensic Signature Verification
Muhammad Imran Malik,Sheraz Ahmed,Marcus Liwicki,Andreas Dengel
firstname.lastname@dfki.de,marcus.liwicki@unifr.ch

Abstract
This paper presents a novel signature verification system based on local features of signatures. The proposed system uses Fast Retina Keypoints (FREAK) which represent local features and are inspired by the human visual system, particularly the retina. To locate local points of interest in signatures, two local keypoint detectors, i.e., Features from Accelerated Segment Test (FAST) and Speeded-up Robust Features (SURF), have been used and their performance comparison in terms of Equal Error Rate (EER) and time is presented. The proposed system has been evaluated on publicly available dataset of forensic signature verification competition, 4NSigComp2010, which contains genuine, forged, and disguised signatures. The proposed system achieved an EER of 30%, which is considerably very low when compared against all the participants of the said competition. In addition to EER, the proposed system requires only 0.6 seconds on average to verify a 3000*1500 scanned signature. This shows that the proposed system has a potential and suitability for forensic signature verification as well as real time applications.

I. INTRODUCTION
Automatic signature verification is needed in various different areas of our daily life. These include banks, governmental, security, and financial institutions, etc. Since the last few decades, researchers from Pattern Recognition (PR) community are developing and continuously improving different automatic signature verification systems for both offline (where only spatial information of signatures is available) and online (where both spatial and temporal information of signatures is available) cases. In either case, (online or offline), the verification problem is usually solved by classifying signatures into two classes, i.e., either as genuine or forged. This classification is helpful in many cases, but in some areas, e.g., forensic handwriting/signature analysis, another important genre of signatures, i.e., disguised signatures, needs classification. Although in forensic examination, disguised signatures are of high importance [1], yet they are often neglected by PR researchers [2].
Disguised signatures are usually difficult to identify [2], as they are written by the genuine author but with intention to deny its authorship. This could be done mainly for fraud e.g., a disguised signature made on a bank check can be used to withdraw cash and later on it can be claimed that the check did not contain original signatures.. In such a case, it is very difficult for bank/financial institution officers to distinguish between genuine and disguised signatures. In addition, it is also not possible to have an expert forensic examiner available in all of the institutes, which require authentication via signatures, who can first analyze signatures and then allow the next step in the routine work flow. It is, therefore, required to enable automatic systems classify the three different genres of signatures, i.e., genuine, forged, and disguised, so that different types of such frauds can be prevented.
Existing systems for automatic signature verification are already performing very well if the goal is to identify genuine and forged signature [2]. There are already some commercial systems available which are also being used in banking and other financial and sensitive institutions. However, to the best of our knowledge, there are only a few systems capable of disguise classification and most of them have appeared first time in the 4NSigComp2010 signature verification competition. Note that, these systems performed quite naively when disguised signatures were present in the test set and the best of these systems could reach an EER of 55%. Considering the above mentioned scenario, there is a strong need for a system which is capable of dealing with genuine, forged, and disguised signatures at the same time with reasonably low EER.
In this paper we propose a novel method for automatic signature verification, which is able to deal with genuine, forged, and disguised signatures at the same time, with comparatively low EER and very high time efficiency. The proposed method is based on part-based analysis of signature images. In particular FREAK features are used which are inspired by human visual perception. In addition to EER, the proposed method is also computationally efficient and only requires 0.6 seconds, on average, to verify an offline signature of dimensions nearly 3000∗1500. This shows that there is a strong potential for using the proposed method in various real time scenarios, such as the bank scenarios noted earlier. Furthermore, the proposed method is evaluated on the publicly available dataset of 4NSigComp2010 (the first ever signature verification competition with data containing disguised along with genuine and forged signatures). This data is collected by Forensic Handwriting Examiners (FHEs) from forensic-like situations [2].
The rest of the paper is organized as follows. Section II summarizes different automatic verification systems available for signatures. Section III provides details about the proposed system for forensic signature verification. Section IV details the dataset used for evaluation. Section V presents evaluation results in terms of EER, and execution speed on the said publicly available dataset. Finally, Section VI concludes the paper and provides hints for possible future improvements.

II. RELATED WORK
Signature verification has remained an active field in the last few decades. The recent state-of-the-art of signature verification is summarized in [3]. Nearly all of the stateof-the-art methods have been tested for detection of genuine and forged signatures but disguised signatures are generally neglected, apart from some initial research, like [4], and in some comparative studies of local and global feature based methods, like [5].
Recently, a system for online forgery and disguise detection has been developed which combines online signature features through several classifiers [6]. This system, however, is online and forensic experts are usually interested in offline automatic verification. Furthermore, it does not suit the disguise signature classification scenario on bank checks since the bank check disguise can often occur when the original author is not physically present there, otherwise if s(he) is present there then s(he) may not disprove this fact later as there may be other witnesses. Unlike disguised signatures, disguised handwriting in general is previously considered in some PR-research like [7]. However, [7] only focuses the disguise and genuine handwriting and this does not completely suffice the needs of handwriting experts.
The FAST keypoint detector, which we have used to initially identify the signatures’ local regions of interest, has been previously used mainly for problems like multiple object tracking [8], object recognition for smart phone platforms [9], and recognition of degraded handwritten characters [10]. The SURF Keypoint detector, which we have also used to initially identify the signatures’ local regions of interest in one of our experiments, in conjunction with SURF keypoint descriptor has been previously used heavily for object and character recognition, such as in [11], [12], [13].
The novelty of our work is the explicit use of FAST and SURF keypoint detectors and FREAK local features for offline verification to cater the complete signature verification paradigm including disguised signatures. To the best of the authors’ knowledge, the proposed system is the first automatic system combining the traditionally known keypoint detectors and descriptors (FAST + FREAK, and
SURF + FREAK) for the purpose of signature verification and also reporting the efficiency of these systems in terms of time.

III. METHODOLOGY
The proposed approach for signature verification is based on part-based/local features. To perform part-based analysis, it is first required to extract keypoints from the signature images. The regions around these keypoints are then described using different descriptors. Hence, in the proposed approach, FAST [14] keypoint detector is used to detect keypoints in signature images. FAST keypoint detector is computationally efficient in comparison to well known keypoint detection methods, e.g., SIFT [15], Harris [16], and SURF [11] (we also compare results when we used SURF keypoint detector for finding the potential local areas of interest). In addition, FAST gives a strong response on edges, which makes it suitable for the task of signature verification. Once the keypoints are detected, descriptor for each of the keypoints is computed using recently proposed partbased descriptor, FREAK [17]. FREAK is a binary keypoint descriptor inspired by the retina in human visual system. These features are efficiently computed by sampling area around the keypoint on retinal pattern and encoding it as a binary string by comparing image intensities over this pattern. FREAK features are computationally very efficient in comparison to the well known part-based descriptors, i.e., SIFT [15] and SURF [11]. As the descriptors extracted using FREAK are binary, therefore Hamming distance is used for comparison of descriptors of query and reference signatures. The use of Hamming distance in-turn makes it computationally more efficient as it can be computed using a simple XOR operation on bit level.
To categories a signature as genuine, forged, or disguised, first it is binarized using the well known global binarization method OTSU [18]. We preferred using OTSU since we had fairly high resolution signature images and OTSU is also computationally efficient. After binarization, the following procedure is followed.
1) Apply the FAST keypoint detector on all the reference signatures, separately, to get the local areas of interest from these signatures. 2) Then, get the descriptors of all of these keypoints present in all reference images using the FREAK keypoint descriptor, which describes each keypoint with a 64 bit descriptor. 3) All of these keypoints and their associated descriptors describing important local information are added into a database. This results in a bag-of-features, which contains features for all of the keypoints which are collected from all reference signature images. 4) Once the bag-of-features is created, keypoints and descriptors are extracted for the query/questioned signature.
5) Now a comparison is made between the query signature keypoints and the keypoints present in our bagof-features for that particular author. 6) The same process of detecting local area of interest using FAST and then descriptors by FREAK is applied to the query image. 7) Take the first keypoint of the query Image and compare it with all the features present in the bag of features, one by one. If a query signature keypoint is at a distance less than θ, from any feature present in the bag of features, note the keypoint. 8) Keep this process going until all the query signature’s keypoints are traversed.
9) Calculate the average by considering the total number of query keypoints and the query keypoints matched with the bag-of-features. This represents the average local features of the questioned signature that are present in the bag-of-features of that author. 10) Now, if this average is greater than the threshold θ, (meaning, most of the questioned signature local features are matched with reference local features present in the bag-of-features), the questioned signature is be classified as belonging to the authentic author, otherwise if this average is less than the threshold θ, (meaning, there are only a few query keypoints for whom any match is found in the reference bag-of-
features), it does not belong to the authentic author. The same procedure is followed when we used the SURF keypoint detector instead of the FAST keypoint detector. Classification in both the cases was based on the local descriptions provided by FREAK features.
Figure 1 provides some example signatures where we apply the newly proposed method. Figure 1 (a) shows some sample genuine signatures and the related Figure 1 (b) shows the keypoints extracted from the reference signatures using FAST feature detector. Figure 1 (c) shows a questioned signature that in fact is a forgery attempt. Figure 1 (d) and (e) provide green and red keypoints on this forgery attempt. The green keypoints are those which belong to the query signature but they also matched with the keypoints present in the bag-of-features. The red keypoints are those which belong to the query signature but they did not match with the bag-of-features keypoints. Similarly, Figure 1 (f), (g), and (h) are obtained when the query signature was a disguise attempt. From the Figure 1 (c through e), we can see that for lines which were more or less straight in nature there was a high match of query signature with the reference signature, even if the query signature was a forgery attempt. However, for curved lines/strokes (which are usually very specific of particular individuals) a large number of keypoints mismatched. For disguised query signature, Figure 1 (f through h), larger number of keypoints matched with the reference signatures. This is because the disguise signature belonged to the original/authentic author who left some traces of her/his identity while trying to disguise. This can be attributed to the same brain motor activity which is always utilized whether a person is trying to disguise or not.

IV. DATASET
We used the evaluation set of the 4NSigComp2010 signature verification competition. This is the first ever publicly available dataset containing disguised signatures. The collection contains only offline signature samples. The signatures are collected by forensic handwriting examiners and scanned at 600 dpi resolution. The collection contains 125 signatures. There are 25 reference signatures by the same writer and 100 questioned signatures by various writers. The 100 questioned
signatures comprise 3 genuine signatures written by the reference writer in her/his normal signature style and 7 disguised signatures written by the reference writer where s(he) tried to disguise herself/himself (the reference writer provided a set of signatures over a five day period); and 90 simulated signatures (written by 34 forgers freehand copying the signature characteristics of the reference writer. The forgers were volunteers and were either lay persons or calligraphers.). All writings were made using the same make of ball-point pen and using the same make of paper.
We used the same experimental protocol as was used in the 4NSigComp2010. For training, 25 genuine reference signatures were available and after training on these 25 genuine reference signatures our systems had to classify correctly the 100 questioned signatures (the test set). Note that, no forgery was used for training and yet our systems were able to classify. This is a realistic forensic scenario [2] and is posed in the 4NSigComp2010.

V. EVALUATION
As mentioned above, our evaluation data contained 3 genuine, 7 disguised, and 90 forged signatures. This is not a problem for the evaluation since we computed the Equal Error Rates (EER), calculated when the False Reject Rate (rate at which genuine and/or disguised signatures are misclassified as forged by a system) is same as the False Accept Rate (rate at which forged signatures are misclassified as genuine by a system).
We performed two experiments for evaluating the efficiency and EER of the proposed system.
• Experiment 1 that focused the classification of disguised, forged, and genuine signatures using FAST Kepypoint detector and FREAK features. • Experiment 2 that focused the same classification using SURF Kepypoint detector and FREAK features.
The results of these experiments are provided in Table I. As shown in the table, both of our newly proposed systems, i.e., SURF-FREAK and FAST-FREAK outperform all the participants of the 4NSigComp2010 signature verification competition. The best system from the competition could achieve an EER of 55% in presence of disguised signatures in the test set. Both of the proposed systems, however, achieve an EER of 30% which is remarkable when compared to the other systems.
Furthermore, Table I also presents the performance comparison of the said systems on the basis of time. The time is given in seconds and is actually the average time taken by any algorithm to report its result on the authenticity of one questioned signature. For reporting this result, the system has to process the questioned as well as 25 reference signatures. Both of the proposed systems again outperformed all the participants. Specially the FAST-FREAK method is extremely time efficient. It succeeds from the other eight methods by a times of (520, 3240, 141, 31, 75, 1216,
108, and 20, respectively). We performed all the tests at a machine with following specifications.
• Processor: Intel Dual Core 1.73 GHz • Memory: 1GB • OS: WinXP Professional A general drawback of most of the local features based approaches is the enormous amount of time they take to compute results. In our experiments, most of the participating systems were relying on global features except the proposed systems, yet the execution of the proposed systems was fairly time efficient than other mainly global features based systems. This shows that, if utilized properly, local feature approaches show the potential of improving both performance and efficiency of classification.

VI. CONCLUSION AND FUTURE WORK
In this paper we have presented a novel part based system for forensic signature verification involving disguised signatures. We performed two experiments with two different local feature detectors, namely SURF and FAST. In both of these cases we used FREAK features and applied our novel methodology to classify genuine, forged, and disguised signatures. Both the proposed systems outperformed all the participants of the 4NSigComp2010 signature verification competition by achieving an EER of 30%. Whereas the EER of the best participant in the said competition was 55%.
Furthermore, we have made a time efficiency comparison between the proposed methodology and the participants of the 4NSigComp2010. Although, our approach is based on local feature analysis, yet it is capable of performing classification with better EER and manifold faster execution.
In future we plan to use larger data sets where disguised signatures from large number of authors are present in the test set. Regarding the systems’ outcomes, we plan to enable them produce likelihood ratios according to Bayesian approach, which will make these systems even more useful in the real world forensic casework. This, however, is a difficult task since respective likelihood computation of multiple classes is required in this case.

References
[1]L. MichelDisguised signaturesJournal of the Forensic Science Society, vol. 18, pp. 25–29, 1978.1978
[2]M. Liwicki,C.E. van den Heuvel,B. Found,M.I. MalikForensic signature verification competition 4NSigComp2010 - detection of simulated and disguised signaturesICFHR, 2010, pp. 715–720.2010
[3]D. Impedovo,G. PirloAutomatic signature verification: The state of the artIEEE Trans. on Systems, Man, and Cybernetics, Part C (Applications and Reviews), vol. 38, no. 5, pp. 609–635, Sep. 2008.2008
[4]R. Plamondon,G. LoretteAutomatic signature verification and writer identification – the state of the artPattern Recognition, vol. 22, pp. 107–131, 1989.1989
[5]M.I. Malik,M. Liwicki,A. DengelEvaluation of local and global features for offline signature verification1st. Int. Workshop on Automated Forensic Handwriting Analysis, 2011, pp. 26–30.2011
[6]A. Hassaine,S. Al-MaadeedAn online signature verification system for forgery and disguise detectionNeural Information Processing, ser. Lecture Notes in Computer Science, T. Huang, Z. Zeng, C. Li, and C. Leung, Eds. Springer Berlin Heidelberg, 2012, vol. 7666, pp. 552–559.2012
[7]C.D. Stefano,A. Marcelli,M. RendinaDisguising writers identification: an experimental study14th IGS, 2009, pp. 99–102.2009
[8]K. Jeong,H. MoonObject detection using fast corner detector based on smartphone platformsComputers, Networks, Systems and Industrial Engineering (CNSI), 2011 First ACIS/JNU International Conference on, may 2011, pp. 111 –115.2011
[9]P. Bilinski,F. Bremond,M.B. KaanicheMultiple object tracking with occlusions using hog descriptors and multi resolution imagesCrime Detection and Prevention (ICDP 2009), 3rd International Conference on, dec. 2009, pp. 1 –6.2009
[10]M. Diem,R. SablatnigRecognition of degraded handwritten characters using local featuresDocument Analysis and Recognition, 2009. ICDAR ’09. 10th International Conference on, july 2009, pp. 221 –225.2009
[11]H. Bay,A. Ess,T. Tuytelaars,L. Van GoolSpeeded-up robust features (surf)Comput. Vis. Image Underst., vol. 110, no. 3, pp. 346–359, Jun. 2008. [Online]. Available: http://dx.doi.org/10.1016/j.cviu.2007.09.0142008
[12]W. Song,S. Uchida,M. LiwickiComparative study of part-based handwritten character recognition methods11th ICDAR, 2011, pp. 814–818.2011
[13]D.-N. Ta,W.-C. Chen,N. Gelfand,K. PulliSurftrac: Efficient tracking and continuous object recognition using local feature descriptorsCVPR, 2009, pp. 2937–2944.2009
[14]E. Rosten,T. DrummondFusing points and lines for high performance trackingComputer Vision, 2005. ICCV 2005. Tenth IEEE International Conference on, vol. 2, oct. 2005, pp. 1508 –1515 Vol. 2.2005
[15]D. LoweObject recognition from local scale-invariant featuresComputer Vision, 1999. The Proceedings of the Seventh IEEE International Conference on, vol. 2, 1999, pp. 1150 –1157 vol.2.1999
[16]C. Harris,M. StephensA combined corner and edge detectorIn Proc. of Fourth Alvey Vision Conference, 1988, pp. 147–151.1988
[17]A. Alahi,R. Ortiz,P. VandergheynstFreak: Fast retina keypointComputer Vision and Pattern Recognition (CVPR), 2012 IEEE Conference on. IEEE, 2012, pp. 510– 517.2012
[18]N. OtsuA threshold selection method from gray-level histogramsAutomatica, vol. 11, no. 285-296, pp. 23–27, 1975. 9751975
