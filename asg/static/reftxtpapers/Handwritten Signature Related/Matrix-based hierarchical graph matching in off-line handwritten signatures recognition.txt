Matrix-based hierarchical graph matching in off-line handwritten signatures recognition
Marcin Piekarczyk,Marek R. Ogiela
marp@up.krakow.pl,mogiela@agh.edu.pl

Abstract
In this paper, a graph-based off-line handwritten signature verification system is proposed. The system can automatically identify some global and local features which exist within different signatures of the same person. Based on these features it is possible to verify whether a signature is a forgery or not. The structural description in the form of hierarchical attributed random graph set is transformed into matrix-vector structures. These structures can be directly used as matching pattern when examined signature is analyzed. The proposed approach can be applied to off-line signature verification systems especially for kanji-like or ideogram-based structurally complex signatures.

I. INTRODUCTION
The common approach in handwritten signatures verification systems is using of statistical pattern recognition methods [1,4-5,13]. The most popular models are HMM [6], SVM [14], ANN or DTW. Though the syntactic methods in pattern recognition can be very effective [3] these are not very popular in biometrics. Also, graph-based modeling techniques are rather rarely used by researchers in this field. Among possible reasons of the situation some difficulties related to analysis of such complicated structures as graphs, can be indicated. These types of problems appear both in syntacticoriented and template matching approaches. If the formal graph languages are used, it is necessary to cope with the high complexity membership problem (parsing) and extremely hard designing of the grammatical inference procedures (learning). On the other side, using the template matching model faced with the issue of testing the graph isomorphism in the effective way. In spite of that, some proposals of HSV systems basing on graph-based modeling has been appeared in the recent years including [16] for on-line and [12] for off-line signatures recognition. In both cases the graph-based modeling is used to handle the distinctive features connected with handwritten signatures.
The paper [12] introduces a mathematical linguistic based model designed for distorted or ambiguous patterns, where a graph based approach is used for structure representation. The concept basing on the use of hierarchical random IE graphs and two-level probabilistic grammars belonging to the ETPL(k) class with the aim of gathering and analyzing the knowledge about the structure and the features of ambiguous patterns (signatures). The knowledge about variability of a specimen is created just on the basis of finite number of patterns treated as positive samples of unknown graph language. Additionally, the usage of attributed graphs enables the storage of additional semantic information describing the local properties of the signature. The graph linguistic formalisms applied – the IE graphs and attribute-controlled ETPL(k) grammar [9,12] – are characterized by considerable descriptive strength and a polynomial membership problem of the syntactic analysis. However, the effective mechanism of machine learning through grammatical inference process has been defined [9,13]. This model is very comprehensive but its constructional complexity may be treated as significant disadvantage.
In the approach designed to on-line handwritten signatures analysis [16] different type of graph-based modeling has been presented. On-line signatures are represented by series of graphs, whose nodes and edges describe certain properties of sample points and relationship between points respectively. The collection of graphs is stored in the matrix-oriented form not as a formal graph grammar like in [13]. Then, graph matching techniques are introduced to compute edit distance between graphs. This way it is possible to measure the similarity of the graphs. Calculating the edit distance between the graphs on the basis of adjacency matrices allows to avoid a difficulties related to syntactic approach (like complexity of parsing) and give the opportunity to obtain considerable simplification of the classifier construction in relation to mathematical linguistics approach.
Due to the known instability of the signing process and consequently signature features in both systems the inexact graph matching algorithms have been used. In [12] it is done by utilization of the random graphs while in [16] the classifier is responsible to handle it.
The aim of this paper is to introduce a matrix-oriented classifier for the graph-based model of a signature representation proposed in [12]. It seems that simplification of the classifier construction can be useful and profitable despite existing an effective solution basing on mathematical linguistics. In the paper novel matrix-based representation of hierarchical and probabilistic graph structures is well defined and a discussion on matrix-oriented matching scheme is investigated.

A. Sigle signature representation
According to [15] the thinned signature is used as a basis for creating a structural description. The primary components are strokes contained between the ends and the branch points of the thinned signature.
Connected fragments of the thinned signature are considered as graphemes. The illustration of this preprocessing phase is depicted on Fig. 1.
In the considered hierarchical graph-based model [12] the two separated graph layers are defined (Fig. 2):
• top layer – single meta-graph responsible for preserving the spatial relations between individual graphemes (global features of the signature), • bottom layer – set of attributed graphs associated with top layer graph nodes which enables the storage of additional semantic information (in the form of a set of parameters) about local features of the strokes.
A single grapheme (bottom layer in Fig.2) is represented as the attributed IE graph [12], in which semantic information referring to the shape parameters is associated only with the graph nodes. In this layer the graph nodes represent the primary components (strokes), while edges - the relation of direct contiguity (the touching of strokes). Directional labels determining spatial relation are defined in resolution of 15 angle degree (Fig. 3). The directions are calculated between the centers of gravity of the individual graphemes or strokes.
At the graph representation depicted on Fig. 2 the node labels are intentionally omitted. In the genuine syntactic model [12] the labeling process is a necessary condition because node-controlled ETPL(k) graph grammars are applied. In our proposal due to the matrix-based representation such labeling process is not required. In this point we should pay also attention on the way of the semantic representation. In paper [12] the parametric shape description has been composed of complex Zernike moments. In general it is not only solution possible to consider. Instead of the original parameters the utilization of shape factors, Hu moments [14] or normalized sequence of points with DTW implementation is feasible.

B. Representation of a series of genuine signatures
In order to ensure the completeness of the recognition system [12], the representation of individual handwritten signatures must be supplemented by a mechanism to store information about permitted specimen signatures for a given person.
Such signatures usually differs among themselves both in global and local level because of the instability of the signing process realization as presented in Fig. 4. In the described approach [12] a random IE graphs are used to store aggregated information concerning acceptable level of signatures variation (acceptable variants).
Deterministic graphs from the learning set (Fig. 5) are automatically transformed to the probabilistic representation basing on the structural isomorphism [9]. The operation is executed in both hierarchical layers preserving the existing associations between graphs. The exemplary realization of this phase for bottom layer graphs is presented in Fig. 6.
III. MATRIX-ORIENTED MATCHING MODEL At this stage the original model [12] assumes that appropriate mathematical linguistics methods should be executed including grammatical inference and graph parsing. The processes of automatic inference and parsing for grammars, and for graph grammars in particular, are always very sophisticated and require lots of calculations. To avoid these inconveniences the novel hybrid approach using matrix-oriented graph matching is proposed. The structural description in the form of hierarchical attributed random graph set is transformed into matrix-vector structures. These structures can be directly used as matching pattern when examined signature is analyzed. That approach has at least the two essential advantages:
• allow to avoid the high complexity grammatical inference process,
• enable to utilize the matrix-based representation for examination of the isomorphism of graphs by methods other than classical syntactic analysis.

A. Matrix-based representation for single signature
For this purpose it is necessary to make a matrix representation both for single signature (hierarchical deterministic graphs) and learning set of signatures (hierarchical random graphs). We need the collection of matrices because the hierarchical graph is consisted of set of associated graphs. Every matrix will represent a single graph.
In our proposal we use modified adjacency matrices for graphs and additional matrices for shape parameters. Because IE graphs are directed graphs (digraphs) the adjacency matrix will be interpreted as follows:
• non-zero value for the given aij element of the matrix means that exist the edge from node indexed i to node indexed j,
• value of the aij element – if non-zero – encodes directional (edge) labels according the following formula: {ei} {i + 1} e.g. {e0,…,e23} {1,…,24}.
Depending on graph category the appropriated matrices will be denoted as TL (Top-Layer) lub BL (Bottom-Layer). The whole quantity of the BL matrices strictly depends on number of nodes of the hierarchical graph that is on TL matrix dimension. Sample matrices for selected graphs depicted in Fig. 1 are presented by (1) and (2). TL matrix (1) represents top layer hierarchical graph. BL1 matrix (2) refers to bottom layer graph associated with top layer node indexed by 1.
= 000 100 0240 TL (1)
= 0000000 0000000 0000000 5800000 00244000 0000000 0000120 1BL (2)
Therefore, to keep the effective representation of the single signature we need N + 1 matrices for mapping the graphs where N denotes the number of nodes in hierarchical graph. Moreover, there is necessity of handling the parametrical information associated with bottom layer graphs (shape parameters). To fulfill this these requirements one more structure in form of P matrix (3) is defined.
=
kp
p P 1 1 (3)
For given BLi matrix with dimensions n × n the corresponding P matrix has dimensions n × 1. The matrix may be recognized as vector of composite elements pi where each element is also a vector of coefficients pi = {p1, … ,pm}. The number denoted as m determines how many unique values of parameters is used in modeling the strokes properties.
Concluding, we can store the whole hierarchical graph structure sufficient for the representation of the single handwritten signature as a four D = (N,TL,{BLi},{Pi}), where N denotes the number of hierarchical graph nodes and i denotes the node index of the top layer graph (TL). In the four there is a single instance of the TL matrix while {BL} and {P} denotes the sets of the matrices.

B. Matrix-based representation for series of patterns
Additionally, we need to handle the matrix-based representation for learning set of signatures. To cope with this problem we may easily extend the previously introduced matrix-based notion for single signature. The extension has to meet the requirements imposed by random graph structure i.e. random labels. The new types of matrices are denoted as RTL, RBL and RP respectively, where the first letter R means random. Because the edge labels in the random graphs are composed of list of directional labels therefore we also permit to keep the sets of values as elements in RTL and RBL matrices. The example of RBL matrix for hierarchical random graph from Fig. 6 is presented in (4).
=
}0{}0{}0{}0{}0{ }0{}0{}0{}0{}0{
}24,1{}5,4{}0{}0{}0{ }0{}0{}0{}0{}0{ }0{}0{}24{}2,1{}0{ RBL (4)
In the similar way, also the RP matrices have to be transformed to handle the association of the many vector of parameters with
single random node. Because of this, the RP matrices (5) are defined with dimensions n × k, where k denotes the number of deterministic graphs used in composing the single random graph.
=
kmk
m
pp
pp RP
1
111 1
3 (5)
Taking into account the defined above matrices we can store the matrix-based representation of a learning set (many signatures) as a four R = (N,RTL,{RBLij},{RPij}), where N denotes the number of hierarchical random graph nodes, i denotes the node index of the top layer graph and j denotes the variant number. The j denotes the variant number because single random node can be associated with more than one bottom layer graph (variability within graphem structure).
The mentioned above R data structure is able to keep the information related to single hierarchical random graph. In practice, there is usually necessary to use more than one hierarchical random graph to handle all signature variants at the graphemes level. In formal way we can note it as RV = {Rt}, where t denotes the amount of variants. The number may vary according to quantity of the learning set.

C. Matching algorithm
While the all indispensable matrix-based data structures have been successfully defined in the previous sections now we can describe the proposed matching algorithm. The final aim is to verify if examined signature is similar enough to learning set. In syntactic approach [12] it is done by membership problem solving.
In our new proposal the mathematical linguistic mechanism has been transformed into direct checking the graphs isomorphism basing on matrix-based structures comparing. In the case of graph matrices this process runs identity verification successively for all elements. In practice it is
simple checking if the examined element (from TL or BL matrices) belongs to set of elements (from RTL or RBL matrices). For P and RP matrices regular metric distance and threshold-based cutting is applied. In original approach [12] the Canberra distance has been used.
Formally the matching algorithm could be presented as in the Fig. 7.
IV. DISCUSSION AND CONCLUSION The paper describes new matrix-based matching algorithm for the effective analysis of handwritten signatures. It is faster and has lower complexity than syntactic one presented in [12]. Apart from the handwritten signature biometrics field the particularly promising could be the application of this system in cognitive analysis [2,7,8], knowledge collecting systems like medical image understanding [15] or learning systems [17].
An initial assessment of the precision of the method has been effected on a small signature dataset – five different persons, latin-style signatures. The rest parameters has been similar to the one described in [12]. The obtained results are comparable with [12].
In the future our research will concentrate on improving the effectiveness of the mechanism by the modification both parameter representation and selected matching rules. We plan using DTW-oriented representation and matching at the parameters level. It appears necessary to take into consideration the pseudo-dynamic characteristics of signatures. It seems possible to do when DTW-oriented representation and genuine grayscale date will be combined.
ACKNOWLEGMENTS We kindly acknowledge the support of this study by a
Pedagogical University of Krakow Statutory Research Grant.

References
[1]P. BoribalburephanSakboonyarat, “An algorithm development for handwritten character recognition by personal handwriting identity analysis [PHIA],4th International Conference on Knowledge and Smart Technology (KST),2012
[2]T. Hachaj,M.R. OgielaSemantic Description and Recognition of Human Body Poses and Movement Sequences with Gesture Description Language,Computer Applications for Bio-technology, Multimedia, and Ubiquitous City, Communications in Computer and Information Science,2012
[3]D. Impedovo,G. Pirlo,R. PlamondonHandwritten Signature Verification: New Advancements and Open Issues,International Conference on Frontiers in Handwriting Recognition (ICFHR),2012
[4]G. Fengjun,C. ShijieGesture Recognition Techniques in Handwriting Recognition Application,International Conference on Frontiers in Handwriting Recognition (ICFHR),2010
[5]P. Kumawat,A. Khatri,B. NagariaComparative Analysis of Offline Handwriting Recognition Using Invariant Moments with HMM and Combined SVM-HMM Classifier,International Conference on Communication Systems and Network Technologies (CSNT),2013
[6]L. OgielaUBIAS Systems for Cognitive Interpretation and Analysis of Medical ImagesOpto-Electronics Review,2009
[7]L. Ogiela,M.R. OgielaCognitive Techniques in Visual Data Interpretation,2009
[8]M.R. Ogiela,M. PiekarczykRandom graph languages for distorted and ambiguous patterns: single layer model,Proceedings of the Sixth International Conference on Innovative Mobile and Internet Services in ubiquitous computing2012
[9]Pal,Srikanta,Michael Blumenstein,Umapada PalOff-line signature verification systems: a survey,Proceedings of the International Conference & Workshop on Emerging Trends in Technology,2011
[10]H. Pesch,M. Hamdani,J. Forster,H. NeyAnalysis of Preprocessing Techniques for Latin Handwriting Recognition,2012
[11]M. PiekarczykHierarchical Random Graph Model for Off-line Handwritten Signatures Recognition,Proc. of International Conference on Complex, Intelligent and Software Intensive Systems 2010 (CISIS2010/IMIS2010), IEEE CS Press,2010
[12]M. Piekarczyk,M.R. OgielaHierarchical Graph-Grammar Model for Secure and Efficient Handwritten Signatures Classification,Journal of Universal Computer Science (JUCS),2011
[13]M.K. Randhawa,A.K. Sharma,R.K. SharmaOff-line signature verification based on Hu’s moment invariants and zone features using support vector machine,International Journal of Latest Trends in Engineering and Technology,2012
[14]M. Trzupek,M.R. OgielaInformation Fusion Approach in Computer- Aided Detection of Pathological Changes,Intelligent Decision Technologies,2012
[15]K. Wang,Y. Wang,Z. ZhangOn-line Signature Verification usingGraph Representation,Proc. 6th Int. Conf. on Image and Graphics (ICIG), Hefei, Anhui,2011
[16]K. WojcikHierachical Knowledge Structure Applied to Image Analysis System – Possibilities of Practical Usage,LNCS, 2011,2011
